# :star: 4-5 픽스처 수정하기

<br>

지금까지 작성한 테스트 코드를 통해 픽스처를 불러와 그 속성을 확인하는 방법을 알 수 있었습니다. 그런데 실전에서는 사용자가 값을 변경하면서 픽스처의 내용도 수정되는 경우가 흔합니다.

<br>

이러한 수정 대부분은 세터에서 이뤄지는데, 세터는 보통 아주 단순하여 버그가 생길 일도 별로 없으니 잘 테스트하지 않습니다. 하지만 Producer의 production() 세터는 좀 복잡한 동작을 수행하기 때문에 테스트해볼 필요가 있습니다.

<br>

```js
// describe('province'...)
it('change production', function () {
  asia.producer[0].production = 20;
  expect(asia.shortfall).equal(-6);
  expect(asia.profit).equal(292);
});
```

<br>

흔히 보는 패턴입니다. beforeEach 블록에서 '설정'한 표준 픽스처를 취해서, 테스트를 '수행'하고, 이 픽스처가 일을 기대한 대로 처리했는지를 '검증'합니다. 테스트에 관해 공부를 좀 했다면 이 패턴을 설정-실행-검증(setup-exercise-verify), 조건-발생-결과(given-when-then), 준비-수행-단언(arrange-act-assert) 등으로 부른다는 것을 알 것입니다. 이 세 가지 단계가 한 테스트 안에 모두 담겨 있을 수도 있고, 초기 준비 작업 중 공통되는 부분을 beforeEach와 같은 표준 설정 루틴에 모아서 처리하기도 합니다.

<br>

---

> '해체(teardown)' 혹은 청소(cleanup)라고 하는 네 번째 단계도 있는데 명시적으로 언급하지 않을 때가 많습니다. 해체 단계에서는 픽스처를 제거하여 테스트들이 서로 영향을 주지 모사게 막습니다. 설정을 모두 beforeEach에서 수행하도록 작성해두면, 테스트들 사이에 걸친 픽스처를 테스트 프레임워크가 알아서 해체해주기 때문에 굳이 단계를 나눌 필요는 없습니다. 실무에서도 해체 단계는 무시할 때가 많아서 테스트 관련 글을 보면 대부분 적당히 설명하고 넘어갑니다. 그런데 드물지만 해체를 명시적으로 수행해야 할 때가 있습니다. 특히 생성하는 데 시간이 걸려서 여러 테스트가 공유해야만 하는 픽스처가 여기 해당합니다.

---

<br>

이 테스트는 it 구문 하나에서 두 가지 속성을 검증하고 있습니다. 일반적으로 it 구문 하나당 검증도 하나씩만 하는게 좋습니다. 앞쪽 검증을 통과하지 못하면 나머지 검증은 실행해보지 못하고 테스트가 실패하게 되는데, 그러면 실패 원인을 파악하는 데 유용한 정보를 놓치기 쉽기 때문입니다. 여기서는 한 테스트로 묶어도 문제되지 않을 저옫로 두 속성이 밀접하다고 판단하여 이렇게 작성했습니다. 별개의 it 구문으로 나누고 싶다면 언제든지 나눌 수 있습니다.

<br>

<br>

## 다음 챕터

- [4.6 - 경계 조건 검사하기](https://github.com/Esoolgnah/Summary_of_Refactoring_2nd_Edition/blob/main/Notes/04_테스트_구축하기/04_06_경계_조건_검사하기.md)

<br>

## 이전 챕터

- [4.4 - 테스트 추가하기](https://github.com/Esoolgnah/Summary_of_Refactoring_2nd_Edition/blob/main/Notes/04_테스트_구축하기/04_04_테스트_추가하기.md)

<br>

## 목록으로

- [목록](https://github.com/Esoolgnah/Summary_of_Refactoring_2nd_Edition/blob/main/Notes/04_테스트_구축하기/04_00_테스트_구축하기.md)
